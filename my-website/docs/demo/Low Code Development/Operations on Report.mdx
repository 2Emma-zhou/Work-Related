---
hide_title: true
---

This section introduces the capability of the element **Report** in **Business Designer** on supOS.
1. Log in to supOS, and then select <img src="https://wordpressfreezonex.oss-accelerate.aliyuncs.com/platform/7.png" /> > **Business Designer**.
2. Create a new application, and then add a new page inside.
3. Drag a **Report** element onto the canvas, and then double-click the report.

<img src="https://wordpressfreezonex.oss-accelerate.aliyuncs.com/4.2/supos/171.png"/>
<table>
<thead>
<tr>
<th>No.</th>
<th>Part</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Toolbar</td>
<td>Contains all tools you use on the table.</td>
</tr>
<tr>
<td>2</td>
<td>Table</td>
<td>Displays the added data, and supports general functions similar to Excel.</td>
</tr>
<tr>
<td>3</td>
<td>Data Source Management</td>
<td>Add data source for the report table.</td>
</tr>
<tr>
<td>4</td>
<td>Report Configuration</td>
<td>Table functions configuration.</td>
</tr>
</tbody>
</table>

## Toolbar

Functions of the report are similar to excel and only special features are listed in this section.

### Start

- Cell Format: Aside from general functions, **Report** provides other different features.

<ul>
<li>Type: Select the cell type from a drop-down list and an edit box, and you can set the options of the drop-down list.<br/>

<img width={450} src="https://wordpressfreezonex.oss-accelerate.aliyuncs.com/4.2/supos/172.png"/>
</li>
<li>Permission: Grant different permissions of the selected cells to different
users in operation center.
<img width={450} src="https://wordpressfreezonex.oss-accelerate.aliyuncs.com/4.2/supos/173.png"/>
</li>
</ul>

- Simulation Analysis

- Filling/Data Entry Template
- Table Style: Select the style of the table, and you can customize new styles under **Customize**.
- Clear Panes: 

### Insert
You can insert charts, rows and columns, images and data sources to the table. For details on inserting data sources, see <a href="">Data Source Management</a>.

### Customize
- Right-Click Menu: You can select actions and click **Edit** to write function script, import, and export the menu to JSON file and call it in other report elements.<br/>
Example codes:
```js
// Reset the target cell
/** __ACTION__START__ **/
spread.suspendPaint();
// set cell value
let cellVal = '';
curCell.value(cellVal);
spread.resumePaint();
/** __ACTION__END__ **/
```
```js
// Open a new page
/** __ACTION__START__ **/
const cellValue = curCell.value(); // cell value
const formul = curCell.formula(); // cell formula
const url = ''; // page url
window.scriptUtil.openPage(url);
/** __ACTION__END__ **/
```
```js
// Open a modal window
/** __ACTION__START__ **/
const cellValue = curCell.value(); // cell value
const formul = curCell.formula(); // cell formula
const config = {
modalTitle: '', // title
url: '' // page url
}; // modal window configuration
window.scriptUtil.renderModal(config);
/** __ACTION__END__ **/
```

<img width={450} src="https://wordpressfreezonex.oss-accelerate.aliyuncs.com/4.2/supos/174.png"/>

- Event Extensions: Customize events such as edit cell, click and finish editing. You can export the event to JSON file and call it in other report elements.<br/>
Example codes:
```js
// Edit cells
// add 4 params, reporter/curCell (currently selected cell)/spread (SpreadJS instance) editingText
console.log("editingText: ", editingText);
console.log(curCell.formula());
setTimeout(function() { // simulate request
spread.suspendPaint();
const res = { status: 400 };
if (res === 400) { // request error
curCell.value(''); // empty the cell
} else {
reporter.reported(); // fill
} spread.resumePaint();
}, 500);
```
```js
// Cell click
//add 3 params, reporter/curCell (currently selected cell)/spread (SpreadJS instance)
const value = curCell.value();
console.log("value: ", value);
const {row, col} = curCell;
spread.suspendPaint();
if (row === 2 && col === 2 && value === 'Print') { // C3 is print
const activeCell = spread.getActiveSheet().getCell(2, 1);
activeCell.formula('=SUM(A1, B2)'); // set formula for A3
reporter.print(); // print report
} spread.resumePaint();
```

<img width={450} src="https://wordpressfreezonex.oss-accelerate.aliyuncs.com/4.2/supos/175.png"/>

## Data Source Management
Add object instances, templates, services or data query commands, and then you can directly drag corresponding attributes, fields or parameters into the report.

:::info
A <strong>key</strong> field is generated after adding object data. It adds a column of index number for those data. Time series data will not generate <strong>key</strong>.
:::

### Adding Object Model

You can add object template, instance and service by selecting <img src="https://wordpressfreezonex.oss-accelerate.aliyuncs.com/appDesign/43.png" /> > <strong>Object Model</strong> under <strong>Data Source Management</strong>. Data type can be real-time and history.

:::info
- Only the first 200 attributes can be displayed of each instance. You can right-click the cell, select <strong>Insert Formula</strong> > <strong>Data Source</strong> to add more.
- Right-click a cell and select <strong>Insert Formula</strong> > <strong>Built-in Function</strong>, enter related information to add a date function to the cell.
:::

- Add object instance

<ol>
<ol>
<li>Select <img src="https://wordpressfreezonex.oss-accelerate.aliyuncs.com/appDesign/43.png"/> > <strong>Object Instance</strong> under <strong>Data Source Management</strong>.</li>
<li>Select an object instance under the <strong> Object instance-property</strong>tab in the pop-up window, and then click <strong>Save</strong>.</li>
<li>Drag the added instance from the list to the report, and then select the cell, configure its properties under <strong>Property Configuration</strong> at the lower-right corner.<br/>

<img src="https://wordpressfreezonex.oss-accelerate.aliyuncs.com/appDesign/83.png"/>

<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Display Type</td>
<td>Select whether to display time or value of the history data in the cell.</td>
</tr>
<tr>
<td>Time Granularity</td>
<td>Time interval at which the history data is integrated and analyzed.</td>
</tr>
<tr>
<td>Numeric Type</td>
<td>Select calculation methods which are applied to the data collected according to the set <strong>Time Granularity</strong>.</td>
</tr>
<tr>
<td>Fill Type</td>
<td>Select the data to fill in the report.

- **Autofill**: Select fill direction and maximum number (1-500) of data to be displayed.
- **Fixed**: Get the data of a fixed index from 1 to 500.

</td>
</tr>
</tbody>
</table>
</li>
</ol>
</ol>

- Add object property or service

<ol>
<ol>
<li>Select <img src="https://wordpressfreezonex.oss-accelerate.aliyuncs.com/appDesign/43.png"/> > <strong>Object Instance</strong> under <strong>Data Source Management</strong>.</li>
<li>Select an object property or service under the <strong>Object Template</strong> or <strong>Object Instance-Service</strong> tab in the pop-up window, and then click <strong>Save</strong>.</li>
<li>Drag the added property or service from the list to the report, and then click the cell, configure its properties under <strong>Property Configuration</strong> at the lower-right corner.

<img src="https://wordpressfreezonex.oss-accelerate.aliyuncs.com/appDesign/84.png"/>

<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Data Source</td>
<td>Switch to other output parameters of the data source.</td>
</tr>
<tr>
<td>Filling Orientation</td>
<td>Select data filling direction.</td>
</tr>
<tr>
<td>Maximum Number</td>
<td>The maximum number of data that can be displayed. It ranges from 0-200.</td>
</tr>
<tr>
<td>Fill and Merge</td>
<td>Enable it and then when filling a cell, adjacent cells on the filling direction will be merged together.</td>
</tr>
</tbody>
</table>
</li>
</ol>
</ol>


### Adding Data Query

Search results of third party data sources such as mysql, oracle, sqlserver and AHNA.

1. Select <img src="https://wordpressfreezonex.oss-accelerate.aliyuncs.com/appDesign/43.png"/> > <strong>Data Search</strong> under <strong>Data Source Management</strong>.
2. Select a data source from databases that have been added under <strong>Global Configuration</strong>.
3. Enter SQL commands.You can preview search results.

:::info
${<em>param</em>} can be used as a unspecific parameter when entering SQL commands. Make sure  the ${<em>param</em>} is displayed the same as the real parameter. For example, the original parameter is 'zhangsan' (string), and the command can be <code>select * from <em>tablename</em> where user='${<em>param</em>}'</code>.
:::

4. Enter <strong>Data Source Name</strong> as the data set for search results.
5. Click <strong>OK</strong>, and then the result data set is displayed under <strong>Data Source Management</strong>.
6. Drag a field to the report, and then click the cell to configure properties.

<img src="https://wordpressfreezonex.oss-accelerate.aliyuncs.com/appDesign/101.png"/>

<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Assign Primary Key</td>
<td>Set a filed in the table to be the primary key. You can also select and combine multiple fields to be a primary key to ensure its uniqueness.</td>
</tr>
<tr>
<td>Type Conversion</td>
<td>Convert time data in Oracle. Placeholder <strong>$$</strong> is used as column name, and <strong>$$$</strong> is value.

:::tip
Input format example
- `to_timestamp($$$,’yyyy-MM-dd HH24:MI:ss.ff’)`: Single cell conversion of data type.
- `cast($$ as decimal(10,2))`: Columndata type conversion.
:::

</td>
</tr>
</tbody>
</table>

## Report Configuration

### Parent Cell
Bind the selected cell with custom parent cell.
- Set one parent cell: Set only one parent cell, the sub cells copy filling direction and number of parent cell and the relative position stays the same.
- Set both cells: Data generated on sub cells will be filtered according to its parent cell to produce result sets that conform to report logics.

Following operations use left parent cell as an example.
1. Set the <strong>Fill Type</strong> of the report to <strong>Insert</strong>.
2. Select a cell to be the sub cell, and then select <strong>Customize</strong> under  <strong>Left Parent Cell</strong>.
3. Select a parent cell for the set sub cell, and enter the cell row and column number.

Generally, select a parent cell with formulas, such as formulas of history data, table data, service data and date function.

<img src="https://wordpressfreezonex.oss-accelerate.aliyuncs.com/appDesign/85.png"/>

:::info
After setting parent cells, data on the table is automatically deduplicated and reorganized evenly. No relations between columns by default and relational data can only be correctly displayed after parent cell settings.
:::

### Aggregation Formula

Calculate cells set with formulas.
1. Drag data into a cell, and set the <strong>Data Type</strong> to <strong>History Data</strong> under <strong>Property Configuration</strong>.
2. Select another cell, and then set a formula to it which relates to the cell with history data.
3. Click <strong>Aggregation Formula</strong> at the lower-right corner.
4. Select <strong>Customize</strong>, and then enter the location of the cell with a formula.

<img src="https://wordpressfreezonex.oss-accelerate.aliyuncs.com/appDesign/86.png"/>

5. Save settings, and then click <strong>Preview</strong>.<br/>

You can see the cell with a formula is displaying calculation results of corresponding formula and hirtory data.

### Operation

You can update and delete data in relational database through setting a cell as a save or delete button under <strong>Operation</strong>.

1. Select an empty cell on the report, select <strong>Data Search</strong> and enter sql commands to obtain a data source for the cell with execution results.

:::tip
For details, see <a href="#data_source_management">Data Source Management</a>.
:::
2. Select another empty cell to be the operation button.
3. Click <strong>Operation</strong> at the power-right corner, and then set the operation.

:::info
The operation button can only be correctly displayed after setting it parent cells.
:::

<img width={350} src="https://wordpressfreezonex.oss-accelerate.aliyuncs.com/appDesign/87.png"/>

<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Table Name</td>
<td>The table name corresponding to fields you want to change.</td>
</tr>
<tr>
<td>Data Source</td>
<td>The data source corresponding to fields you want to change.</td>
</tr>
<tr>
<td>Operation Type</td>
<td>

- <strong>Renew</strong>: You can save the edited cell in operation center.
- <strong>Delete</strong>: You can delete the selected cell in operation center.

</td>
</tr>
<tr>
<td>Operating Range</td>
<td>Select ranges for the operation to apply to.</td>
</tr>
<tr>
<td>Text</td>
<td>The text for the operation button.</td>
</tr>
</tbody>
</table>

4. Select <strong>Format</strong> > <strong>Cell Format</strong> > <strong>Authority</strong> on the report, and then grant read and write permission of the selected cell to users.

<img src="https://wordpressfreezonex.oss-accelerate.aliyuncs.com/appDesign/88.png"/>

5. Enable <strong>Run Edit</strong> for the report under <strong>Property</strong>.
6. Save settings, and then click <strong>Preview</strong>.

:::info
If the primary key of the data source is changed and saved, you need to refresh the current page for further changes.
:::

<span id="report_linkage"></span>


### Report Linkage

You can link the report to other elements such as button, search box and input box to integrate, search for and export important data. In the report, each data source has a corresponding linkage button.

:::info
This chapter demonstrates data linkage of report in free layout.
:::

- History Data Linkage

<ol>
<ol>
<li>Add a data source.</li>
<li>Add two date elements and set them to start and end date respectively.

:::info
Make sure to change the name of both elements. Otherwise, they cannot be bound to the report.
:::

</li>
<li>Select the report and then click <strong>Open</strong> next to <strong>Date Binding</strong> under <strong>Parameter</strong>.</li>
<li>Bind <strong>minDate</strong> and <strong>maxDate</strong> to corresponding start and end date elements, and then click <strong>Save</strong>.
<img width={500} src="https://wordpressfreezonex.oss-accelerate.aliyuncs.com/appDesign/102.png"/>

</li>
</ol>
</ol>

- Form Data Linkage
:::info
This section uses <strong>Data Search</strong> to be the data source as an example.
:::

<ol>
<ol>
<li>Double-click the report, and then under <strong>Data Source Management</strong>, click <strong>Data Search</strong> to add a data source with the result of the sql commands.</li>
<li>Write a sql command and use `${"{"}parameter{"}"}` as the input field that can link with the report.

<img width={500} src="https://wordpressfreezonex.oss-accelerate.aliyuncs.com/appDesign/103.png"/>

</li>
<li>Drag data fields to the report, and then save the table and go back to the page canvas.</li>
<li>Add an input box to the canvas, and the click <strong>Open</strong> next to the data source name you set after writing sql commands, to link the input box to the report.

<img width={500} src="https://wordpressfreezonex.oss-accelerate.aliyuncs.com/appDesign/104.png"/>

</li>
<li>Click <strong>Save</strong>, and then preview the page. <br/>

Enter a parameter in the input box, and then the report displays data filtered based on the input content.

<img width={300} src="https://wordpressfreezonex.oss-accelerate.aliyuncs.com/appDesign/105.png"/>

</li>
</ol>
</ol>


## Report Group

Group the report to display data by time or field.

1. Drag object properties to cells from the data source list, and then set cells that contain the property based on which the report data is grouped to be the parent cell and join them.

<img src="https://wordpressfreezonex.oss-accelerate.aliyuncs.com/appDesign/90.png"/>

2. Use the parent cell data as the general time period, set its property at the lower-right corner.

<ul >
<li>
Set <strong>Data Type</strong> to <strong>History Data</strong>.
</li>
<li>
Set <strong>Display Type</strong> to <strong>Display Time</strong>.
</li>
<li>
Set <strong>Time Granularity</strong> to <strong>1 Week</strong>.
</li>
<li>
Set <strong>Group Key Value</strong> to <strong>Time</strong>.
</li>
<li>
Set <strong>Fill Type</strong> to <strong>Autofill</strong>
and <strong>Filling Orientation</strong> to <strong>Horizontal Padding</strong>.

<img width={350} src="https://wordpressfreezonex.oss-accelerate.aliyuncs.com/appDesign/91.png"/>

</li>
</ul>

3. Similarly, set the property of the first sub cell, which is the time period of groups.

<ul >
<li>
Set <strong>Data Type</strong> to <strong>History Data</strong>.
</li>
<li>
Set <strong>Display Type</strong> to <strong>Display Time</strong>.
</li>
<li>
Set <strong>Time Granularity</strong> to <strong>1 Day</strong>.
</li>
<li>
Set <strong>Group Key Value</strong> to <strong>Time</strong>.
</li>
<li>
Set <strong>Fill Type</strong> to <strong>Autofill</strong>
and <strong>Filling Orientation</strong> to <strong>Vertical Padding</strong>.
</li>
</ul>

4. Set the property of the second sub cell, which is the average flow.

<ul >
<li>
Set <strong>Data Type</strong> to <strong>History Data</strong>.
</li>
<li>
Set <strong>Display Type</strong> to <strong>Display Value</strong>.
</li>
<li>
Set <strong>Time Granularity</strong> to <strong>1 Day</strong>.
</li>
<li>
Set <strong>Numeric Type</strong> to <strong>Average Value</strong>.
</li>
<li>
Set <strong>Group Key Value</strong> to <strong>Time</strong>.
</li>
<li>
Set <strong>Fill Type</strong> to <strong>Autofill</strong>
and <strong>Filling Orientation</strong> to <strong>Vertical Padding</strong>.
</li>
</ul>

5. Set the property of the third sub cell, which is the maximum
temperature.

<ul >
<li>
Set <strong>Data Type</strong> to <strong>History Data</strong>.
</li>
<li>
Set <strong>Display Type</strong> to <strong>Display Time</strong>.
</li>
<li>
Set <strong>Time Granularity</strong> to <strong>1 Day</strong>.
</li>
<li>
Set <strong>Numeric Type</strong> to <strong>Maximum Value</strong>.
</li>
<li>
Set <strong>Group Key Value</strong> to <strong>Time</strong>.
</li>
<li>
Set <strong>Fill Type</strong> to <strong>Autofill</strong>
and <strong>Filling Orientation</strong> to <strong>Vertical Padding</strong>.
</li>
</ul>

6. Save settings and then click <strong>Preview</strong>.

<img src="https://wordpressfreezonex.oss-accelerate.aliyuncs.com/appDesign/92.png"/>

## Related Operations

- Print Report <br/>

Add a button in the design center, add a click event and write a script for the button to print the report in the operation center.

```js
var report = scriptUtil.getRegisterReactDom('
{component ID}').report;{"\n"}report.doPrint();
```

- Export Report <br/>

Add a button in the design center, add a click event and write a script for the button to export the report in the operation center.

```js
var report = scriptUtil.getRegisterReactDom('
{component ID}').report;{"\n"}
report.doExport('xlsx');
```

- Filter Report <br/>

Advanced filter for service or relational data. You can add one or more filtering conditions to view the filtered data in the operation center.

<ol >
<li>Select a cell with data, and then select <strong>Filter</strong> > <strong>Advanced Filter</strong> from the toolbar.</li>
<li>Set filtering conditions in the pop-up window.<ol>
<li>Select whether to apply filtering conditions of the parent cell to the selected cell. If applied, the result conforms to filtering conditions of both cells.

:::info
This is only available when both cells using data from the same data set.
:::

</li>
<li>Select condition types.
<ul >
<li><strong>General</strong>: Define filtering conditions to data columns.</li>
<li><strong>Formula</strong>: Use formulas to set filtering conditions. Presently not
available.</li>
</ul>
</li>
<li>Set filtering conditions, and then click <strong>OK</strong>.

You can add more conditions and set their relations.

<img width={450} src="https://wordpressfreezonex.oss-accelerate.aliyuncs.com/appDesign/89.png"/>

</li>
</ol>
</li>
</ol>
